{% block rednose_widget_editor_widget %}
    <div class="widget_editor">
        {{ block ('textarea_widget') }}
    </div>

    <script language="javascript">
        {% if type == constant('Rednose\\FrameworkBundle\\Form\\Type\\EditorType::TYPE_CKEDITOR') %}
            CKEDITOR.{% if inline %}inline{% else %}replace{% endif %}('{{ id }}', {
                extraPlugins: 'confighelper',

                toolbar: {{ toolbar|json_encode|raw }},

                {% if scayt %}
                    scayt_autoStartup: true,
                    disableNativeSpellChecker: true,
                {% endif %}

                removePlugins: 'elementspath',
                resize_enabled: false,

                scayt_sLang: '{{ locale }}',
                language: '{{ locale }}',
                height: '{{ height }}',

                // Verdana is all we allow. Font choice is only here to correct pasted stuff from other sources,
                // ideally the font and the size are dictated by the configured template for this particular document.
                font_names: 'Verdana'
            });
        {% else %}
            var styleFormats = [],
                cssContent;

            if (typeof(tinymce.style_formats) != 'undefined') {
                styleFormats = tinymce.style_formats;
            }

            if (typeof(tinymce.style_css) != 'undefined') {
                cssContent = tinymce.style_css;
            }

            var toolbar = '{% for bar in toolbar %}{% for item in bar.items %}{{ item }},{% endfor %}|,{% endfor %}';

            // Creates a new editor instance
            var ed = new tinymce.Editor('{{ id }}', {
                theme: 'advanced',
                skin: 'docgen',

                plugins : "paste,fullscreen",

                theme_advanced_buttons1 : toolbar,
                theme_advanced_buttons2 : '',
                theme_advanced_buttons3 : '',

                style_formats: styleFormats,
                content_css: cssContent,

                theme_advanced_toolbar_location : "external",
                theme_advanced_resizing : false,
                theme_advanced_statusbar_location : false,

                //style_formats: styleFormats
            }, tinymce.EditorManager);

            ed.render();
        {% endif %}
    </script>
{% endblock rednose_widget_editor_widget %}
